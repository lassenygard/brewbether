!function($,t,s,i){function e(t,s){this.element=t,this.settings=$.extend({},h,s),this.settings.fontSize||(this.settings.fontSize=this.settings.radius/1.2),this.settings.strokeWidth||(this.settings.strokeWidth=this.settings.radius/4),this._defaults=h,this._name=n,this._init()}var n="countdown360",h={radius:15.5,strokeStyle:"#808080",strokeWidth:void 0,fillStyle:"#ffffff",fontColor:"#bfbfbf",fontFamily:"Arial",fontSize:void 0,fontWeight:700,autostart:!0,seconds:10,label:["minutt","minutter"],startOverAfterAdding:!1,smooth:!0,onComplete:function(){}};e.prototype={getTimeRemaining:function(){return this._secondsLeft(this.getElapsedTime())},getElapsedTime:function(){return Math.round(((new Date).getTime()-this.startedAt.getTime())/1e3)},extendTimer:function(t){var s=parseInt(t),i=Math.round(((new Date).getTime()-this.startedAt.getTime())/1e3);this._secondsLeft(i)+s<=this.settings.seconds&&this.startedAt.setSeconds(this.startedAt.getSeconds()+parseInt(t))},addSeconds:function(t){var s=Math.round(((new Date).getTime()-this.startedAt.getTime())/1e3);this.settings.startOverAfterAdding?(this.settings.seconds=this._secondsLeft(s)+parseInt(t),this.start()):this.settings.seconds+=parseInt(t)},start:function(){this.startedAt=new Date,this._drawCountdownShape(3.5*Math.PI,!0),this._drawCountdownLabel(0);var t=1e3;this.settings.smooth&&(t=16),this.interval=setInterval(jQuery.proxy(this._draw,this),t)},stop:function(t){clearInterval(this.interval),t&&t()},_init:function(){this.settings.width=2*this.settings.radius+2*this.settings.strokeWidth,this.settings.height=this.settings.width,this.settings.arcX=this.settings.radius+this.settings.strokeWidth,this.settings.arcY=this.settings.arcX,this._initPen(this._getCanvas()),this.settings.autostart&&this.start()},_getCanvas:function(){var t=$('<canvas id="countdown360_'+$(this.element).attr("id")+'" width="'+this.settings.width+'" height="'+this.settings.height+'"><span id="countdown-text" role="status" aria-live="assertive"></span></canvas>');return $(this.element).prepend(t[0]),t[0]},_initPen:function(t){this.pen=t.getContext("2d"),this.pen.lineWidth=this.settings.strokeWidth,this.pen.strokeStyle=this.settings.strokeStyle,this.pen.fillStyle=this.settings.fillStyle,this.pen.textAlign="center",this.pen.textBaseline="middle",this.ariaText=$(t).children("#countdown-text"),this._clearRect()},_clearRect:function(){this.pen.clearRect(0,0,this.settings.width,this.settings.height)},_secondsLeft:function(t){return this.settings.seconds-t},_drawCountdownLabel:function(t){this.ariaText.text(s),this.pen.font=this.settings.fontWeight+" "+this.settings.fontSize+"px "+this.settings.fontFamily;var s=this._secondsLeft(t),i=1===s?this.settings.label[0]:this.settings.label[1],e=this.settings.label&&2===this.settings.label.length,n=this.settings.width/2;y=e?this.settings.height/2-this.settings.fontSize/6.2:this.settings.height/2,this.pen.fillStyle=this.settings.fillStyle,this.pen.fillText(s+1,n,y),this.pen.fillStyle=this.settings.fontColor,this.pen.fillText(s,n,y),e&&(this.pen.font="normal small-caps "+this.settings.fontSize/3+"px "+this.settings.fontFamily,this.pen.fillText(i,this.settings.width/2,this.settings.height/2+this.settings.fontSize/2.2))},_drawCountdownShape:function(t,s){this.pen.fillStyle=this.settings.fillStyle,this.pen.beginPath(),this.pen.arc(this.settings.arcX,this.settings.arcY,this.settings.radius,1.5*Math.PI,t,!1),this.pen.fill(),s&&this.pen.stroke()},_draw:function(){var t,s;t=(new Date).getTime()-this.startedAt.getTime(),s=Math.floor(t/6e4),endAngle=3.5*Math.PI-2*Math.PI/(6e4*this.settings.seconds)*t,this._clearRect(),this._drawCountdownShape(3.5*Math.PI,!1),s<this.settings.seconds?(this._drawCountdownShape(endAngle,!0),this._drawCountdownLabel(s)):(this._drawCountdownLabel(this.settings.seconds),this.stop(),this.settings.onComplete())}},$.fn[n]=function(t){var s;return this.each(function(){(s=$.data(this,"plugin_"+n))||(s=new e(this,t),$.data(this,"plugin_"+n,s))}),s}}(jQuery,window,document);